import{t as Y}from"./use-id-2e145a0f.mjs";import{R as Z,P as N,N as $,O as v,u as E}from"./render-0b5e10c9.mjs";import{transition as j,Reason as U}from"./transition-eace808c.mjs";import{o as M}from"./dom-d07dd68d.mjs";import{f as ee,c as te,l as w,p as ne}from"./open-closed-5b41599b.mjs";import{i as k,m as q,j as h,k as S,v as b,x as z,l as T,z as re,q as A,p as F}from"./entry-ce8d72d4.mjs";function f(e=""){return e.split(" ").filter(t=>t.trim().length>1)}let x=Symbol("TransitionContext");var ae=(e=>(e.Visible="visible",e.Hidden="hidden",e))(ae||{});function le(){return A(x,null)!==null}function ie(){let e=A(x,null);if(e===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return e}function oe(){let e=A(O,null);if(e===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return e}let O=Symbol("NestingContext");function L(e){return"children"in e?L(e.children):e.value.filter(({state:t})=>t==="visible").length>0}function D(e){let t=h([]),u=h(!1);b(()=>u.value=!0),z(()=>u.value=!1);function i(r,n=v.Hidden){let a=t.value.findIndex(({id:l})=>l===r);a!==-1&&(E(n,{[v.Unmount](){t.value.splice(a,1)},[v.Hidden](){t.value[a].state="hidden"}}),!L(t)&&u.value&&(e==null||e()))}function d(r){let n=t.value.find(({id:a})=>a===r);return n?n.state!=="visible"&&(n.state="visible"):t.value.push({id:r,state:"visible"}),()=>i(r,v.Unmount)}return{children:t,register:d,unregister:i}}let G=Z.RenderStrategy,ue=k({props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(e,{emit:t,attrs:u,slots:i,expose:d}){if(!le()&&ee())return()=>q(fe,{...e,onBeforeEnter:()=>t("beforeEnter"),onAfterEnter:()=>t("afterEnter"),onBeforeLeave:()=>t("beforeLeave"),onAfterLeave:()=>t("afterLeave")},i);let r=h(null),n=h("visible"),a=S(()=>e.unmount?v.Unmount:v.Hidden);d({el:r,$el:r});let{show:l,appear:B}=ie(),{register:g,unregister:p}=oe(),R={value:!0},m=Y(),c={value:!1},H=D(()=>{c.value||(n.value="hidden",p(m),t("afterLeave"))});b(()=>{let o=g(m);z(o)}),T(()=>{if(a.value===v.Hidden&&!!m){if(l&&n.value!=="visible"){n.value="visible";return}E(n.value,{hidden:()=>p(m),visible:()=>g(m)})}});let I=f(e.enter),J=f(e.enterFrom),K=f(e.enterTo),P=f(e.entered),Q=f(e.leave),V=f(e.leaveFrom),W=f(e.leaveTo);b(()=>{T(()=>{if(n.value==="visible"){let o=M(r);if(o instanceof Comment&&o.data==="")throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")}})});function _(o){let C=R.value&&!B.value,s=M(r);!s||!(s instanceof HTMLElement)||C||(c.value=!0,l.value&&t("beforeEnter"),l.value||t("beforeLeave"),o(l.value?j(s,I,J,K,P,y=>{c.value=!1,y===U.Finished&&t("afterEnter")}):j(s,Q,V,W,P,y=>{c.value=!1,y===U.Finished&&(L(H)||(n.value="hidden",p(m),t("afterLeave")))})))}return b(()=>{re([l],(o,C,s)=>{_(s),R.value=!1},{immediate:!0})}),F(O,H),te(S(()=>E(n.value,{visible:w.Open,hidden:w.Closed}))),()=>{let{appear:o,show:C,enter:s,enterFrom:y,enterTo:ve,entered:de,leave:pe,leaveFrom:me,leaveTo:he,...X}=e;return N({theirProps:X,ourProps:{ref:r},slot:{},slots:i,attrs:u,features:G,visible:n.value==="visible",name:"TransitionChild"})}}}),se=ue,fe=k({inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(e,{emit:t,attrs:u,slots:i}){let d=ne(),r=S(()=>e.show===null&&d!==null?E(d.value,{[w.Open]:!0,[w.Closed]:!1}):e.show);T(()=>{if(![!0,!1].includes(r.value))throw new Error('A <Transition /> is used but it is missing a `:show="true | false"` prop.')});let n=h(r.value?"visible":"hidden"),a=D(()=>{n.value="hidden"}),l=h(!0),B={show:r,appear:S(()=>e.appear||!l.value)};return b(()=>{T(()=>{l.value=!1,r.value?n.value="visible":L(a)||(n.value="hidden")})}),F(O,a),F(x,B),()=>{let g=$(e,["show","appear","unmount","onBeforeEnter","onBeforeLeave","onAfterEnter","onAfterLeave"]),p={unmount:e.unmount};return N({ourProps:{...p,as:"template"},theirProps:{},slot:{},slots:{...i,default:()=>[q(se,{onBeforeEnter:()=>t("beforeEnter"),onAfterEnter:()=>t("afterEnter"),onBeforeLeave:()=>t("beforeLeave"),onAfterLeave:()=>t("afterLeave"),...u,...p,...g},i.default)]},attrs:{},features:G,visible:n.value==="visible",name:"Transition"})}}});export{ue as TransitionChild,fe as TransitionRoot};
