import{P as h,R as D,u as F}from"./render-0b5e10c9.mjs";import{t as w}from"./use-id-2e145a0f.mjs";import{o as v}from"./keyboard-c50452c7.mjs";import{x as O,a as I}from"./calculate-active-index-130b59fd.mjs";import{o as c}from"./dom-d07dd68d.mjs";import{p as $}from"./use-tree-walker-22a8344c.mjs";import{c as A,l as k,p as B}from"./open-closed-5b41599b.mjs";import{b as L}from"./use-resolve-button-type-eb0c2f14.mjs";import{F as j,M as N,w as K}from"./focus-management-bdc6f191.mjs";import{T as U}from"./use-outside-click-efce7701.mjs";import{i as y,j as S,k as x,v as E,x as V,l as q,y as M,q as _,p as J}from"./entry-ce8d72d4.mjs";import"./owner-ef86f285.mjs";import"./use-window-event-f69a4993.mjs";var Q=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(Q||{}),W=(n=>(n[n.Pointer=0]="Pointer",n[n.Other=1]="Other",n))(W||{});function z(n){requestAnimationFrame(()=>requestAnimationFrame(n))}let C=Symbol("MenuContext");function P(n){let b=_(C,null);if(b===null){let g=new Error(`<${n} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(g,P),g}return b}let se=y({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(n,{slots:b,attrs:g}){let d=S(1),e=S(null),m=S(null),r=S([]),p=S(""),s=S(null),f=S(1);function u(l=a=>a){let a=s.value!==null?r.value[s.value]:null,o=K(l(r.value.slice()),R=>c(R.dataRef.domRef)),i=a?o.indexOf(a):null;return i===-1&&(i=null),{items:o,activeItemIndex:i}}let t={menuState:d,buttonRef:e,itemsRef:m,items:r,searchQuery:p,activeItemIndex:s,activationTrigger:f,closeMenu:()=>{d.value=1,s.value=null},openMenu:()=>d.value=0,goToItem(l,a,o){let i=u(),R=O(l===I.Specific?{focus:I.Specific,id:a}:{focus:l},{resolveItems:()=>i.items,resolveActiveIndex:()=>i.activeItemIndex,resolveId:T=>T.id,resolveDisabled:T=>T.dataRef.disabled});p.value="",s.value=R,f.value=o!=null?o:1,r.value=i.items},search(l){let a=p.value!==""?0:1;p.value+=l.toLowerCase();let o=(s.value!==null?r.value.slice(s.value+a).concat(r.value.slice(0,s.value+a)):r.value).find(R=>R.dataRef.textValue.startsWith(p.value)&&!R.dataRef.disabled),i=o?r.value.indexOf(o):-1;i===-1||i===s.value||(s.value=i,f.value=1)},clearSearch(){p.value=""},registerItem(l,a){let o=u(i=>[...i,{id:l,dataRef:a}]);r.value=o.items,s.value=o.activeItemIndex,f.value=1},unregisterItem(l){let a=u(o=>{let i=o.findIndex(R=>R.id===l);return i!==-1&&o.splice(i,1),o});r.value=a.items,s.value=a.activeItemIndex,f.value=1}};return U([e,m],(l,a)=>{var o;t.closeMenu(),j(a,N.Loose)||(l.preventDefault(),(o=c(e))==null||o.focus())},x(()=>d.value===0)),J(C,t),A(x(()=>F(d.value,{[0]:k.Open,[1]:k.Closed}))),()=>{let l={open:d.value===0};return h({ourProps:{},theirProps:n,slot:l,slots:b,attrs:g,name:"Menu"})}}}),ie=y({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"}},setup(n,{attrs:b,slots:g,expose:d}){let e=P("MenuButton"),m=`headlessui-menu-button-${w()}`;d({el:e.buttonRef,$el:e.buttonRef});function r(u){switch(u.key){case v.Space:case v.Enter:case v.ArrowDown:u.preventDefault(),u.stopPropagation(),e.openMenu(),M(()=>{var t;(t=c(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(I.First)});break;case v.ArrowUp:u.preventDefault(),u.stopPropagation(),e.openMenu(),M(()=>{var t;(t=c(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(I.Last)});break}}function p(u){switch(u.key){case v.Space:u.preventDefault();break}}function s(u){n.disabled||(e.menuState.value===0?(e.closeMenu(),M(()=>{var t;return(t=c(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(u.preventDefault(),e.openMenu(),z(()=>{var t;return(t=c(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let f=L(x(()=>({as:n.as,type:b.type})),e.buttonRef);return()=>{var u;let t={open:e.menuState.value===0},l={ref:e.buttonRef,id:m,type:f.value,"aria-haspopup":!0,"aria-controls":(u=c(e.itemsRef))==null?void 0:u.id,"aria-expanded":n.disabled?void 0:e.menuState.value===0,onKeydown:r,onKeyup:p,onClick:s};return h({ourProps:l,theirProps:n,slot:t,attrs:b,slots:g,name:"MenuButton"})}}}),ve=y({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(n,{attrs:b,slots:g,expose:d}){let e=P("MenuItems"),m=`headlessui-menu-items-${w()}`,r=S(null);d({el:e.itemsRef,$el:e.itemsRef}),$({container:x(()=>c(e.itemsRef)),enabled:x(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function p(t){var l;switch(r.value&&clearTimeout(r.value),t.key){case v.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case v.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let a=e.items.value[e.activeItemIndex.value];(l=c(a.dataRef.domRef))==null||l.click()}e.closeMenu(),M(()=>{var a;return(a=c(e.buttonRef))==null?void 0:a.focus({preventScroll:!0})});break;case v.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Next);case v.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Previous);case v.Home:case v.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.First);case v.End:case v.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Last);case v.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),M(()=>{var a;return(a=c(e.buttonRef))==null?void 0:a.focus({preventScroll:!0})});break;case v.Tab:t.preventDefault(),t.stopPropagation();break;default:t.key.length===1&&(e.search(t.key),r.value=setTimeout(()=>e.clearSearch(),350));break}}function s(t){switch(t.key){case v.Space:t.preventDefault();break}}let f=B(),u=x(()=>f!==null?f.value===k.Open:e.menuState.value===0);return()=>{var t,l;let a={open:e.menuState.value===0},o={"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(l=c(e.buttonRef))==null?void 0:l.id,id:m,onKeydown:p,onKeyup:s,role:"menu",tabIndex:0,ref:e.itemsRef};return h({ourProps:o,theirProps:n,slot:a,attrs:b,slots:g,features:D.RenderStrategy|D.Static,visible:u.value,name:"MenuItems"})}}}),pe=y({name:"MenuItem",props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1}},setup(n,{slots:b,attrs:g,expose:d}){let e=P("MenuItem"),m=`headlessui-menu-item-${w()}`,r=S(null);d({el:r,$el:r});let p=x(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===m:!1),s=x(()=>({disabled:n.disabled,textValue:"",domRef:r}));E(()=>{var a,o;let i=(o=(a=c(r))==null?void 0:a.textContent)==null?void 0:o.toLowerCase().trim();i!==void 0&&(s.value.textValue=i)}),E(()=>e.registerItem(m,s)),V(()=>e.unregisterItem(m)),q(()=>{e.menuState.value===0&&(!p.value||e.activationTrigger.value!==0&&M(()=>{var a,o;return(o=(a=c(r))==null?void 0:a.scrollIntoView)==null?void 0:o.call(a,{block:"nearest"})}))});function f(a){if(n.disabled)return a.preventDefault();e.closeMenu(),M(()=>{var o;return(o=c(e.buttonRef))==null?void 0:o.focus({preventScroll:!0})})}function u(){if(n.disabled)return e.goToItem(I.Nothing);e.goToItem(I.Specific,m)}function t(){n.disabled||p.value||e.goToItem(I.Specific,m,0)}function l(){n.disabled||!p.value||e.goToItem(I.Nothing)}return()=>{let{disabled:a}=n,o={active:p.value,disabled:a};return h({ourProps:{id:m,ref:r,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,onClick:f,onFocus:u,onPointermove:t,onMousemove:t,onPointerleave:l,onMouseleave:l},theirProps:n,slot:o,attrs:g,slots:b,name:"MenuItem"})}}});export{se as Menu,ie as MenuButton,pe as MenuItem,ve as MenuItems};
